---
title: "Ejercicios Estimacion y contraste"
author: "Pedro Varona"
date: "2026-01-05"
output: html_document
---
1. Una variable aleatoria tiene media µ desconocida y desviaci´on t´ıpica poblacional 12.5. La media muestral
para una muestra aleatoria de tama˜no 50 es ¯
X =72.4. Halla el intervalo de confianza del 95% para µ.
```{r}
alpha = 0.05
z = qnorm(1 - alpha/2)
x = 72.4
n = 50

low = x - z * (12.5 / sqrt(n))
high = x + z * (12.5 / sqrt(n))

low
high
```



2. La desviaci´on est´andar de las alturas de 16 estudiantes de una escuela de 10000 estudiantes es 2.4 cm.
Encuentra el intervalo de confianza al 95% para la varianza de los estudiantes de la escuela

```{r}
alpha = 0.05
n = 16
x1 = qchisq(1-alpha/2, n-1)
x2 = qchisq(alpha/2, n-1)

low = ((n-1) * (2.4^2)) / x1
high = ((n-1) * (2.4^2)) / x2
low
high
```

3. Una muestra aleatoria de cinco gasolineras madrile˜nas da los siguientes precios en euros por litro de
gasolina: 124.9, 127.9, 130.9, 128.9, 122.9. Halla el intervalo de confianza del 90% para la media de
precios por litro. Haz todas las asunciones que consideres oportunas.

```{r}
alpha = 0.1
n= 5

datos = c(124.9, 127.9, 130.9, 128.9, 122.9)
sd = sd(datos)
x = mean(datos)
t = qt(1-alpha/2, n-1)



low = x - t * (sd/sqrt(n))
high = x + t * (sd/sqrt(n))
low
high
```

4. Una muestra aleatoria de 25 puntuaciones medias de una universidad tiene como media muestral ¯
X =
2.68 y una varianza muestral ˆS2 = 0.322. Asumiendo que las medias de puntuaciones est´an distribuidas
aproximadamente como una normal, hallar el intervalo de confianza del 95% para la media de las
puntuaciones.


```{r}
n = 25
alpha = 0.05
x = 2.68
t = qt(1- alpha/2, n-1)
sd = 0.32

low = x - t * (sd/sqrt(n))
high = x + t * (sd/sqrt(n))
low
high


```
5. Los datos en data test/normal.csv contienen medidas independientes procedentes de una poblaci´on nor
mal. (1) Testea H0: µ > 0. (2) Testea ahora µ < 0. (3) ¿No es esto una contradicci´on?


```{r}
data = read.csv("normal.csv")


# Para media > 0
t.test(data, alternative = c("less"), mu=0, conf.level = 0.95)

# Para media < 0
t.test(data, alternative = c("greater"), mu=0, conf.level = 0.95)
```


6. Unam´aquinasol´ıaproducirunapiezamec´anicaconungrosorde0.05cms. Sinembargo,haysospechas
deque lam´aquinahadejadode funcionaradecuadamente. Paradeterminarsi escierto, setomauna
muestraalazarde10piezas,obteni´endoseunamediade0.053cmyunavarianzade10−5cm2.Testea
si lam´aquinahadejadodefuncionarcorrectamenteal (a)95%y(b)99%deconfianza. (c)Encuentra
elvalordelp-valoryel tama˜nodelefecto.Datosen“pieces.csv”.


```{r}
data = read.csv("pieces.csv")
test = t.test(data, alternative = "two.sided", mu= 0.05, conf.level = 0.95)
test
effectsize(test)

test = t.test(data, alternative = "two.sided", mu= 0.05, conf.level = 0.99)
test
effectsize(test)
```

7.Respectoal ejercicioanterior, ¿Cu´al esel tama˜node lamuestraquesenecesitar´ıaparadetectaruna
variaci´onenlamediade0.003cm,conunasignificaci´ondel1%yunapotenciadel90%.

```{r}

power.t.test(sd = sqrt(10^(-5)), sig.level = 0.01, power = 0.9, delta = 0.003, type = "one.sample", alternative = "two.sided")



```

8.  Lavidamediadeunamuestrade100 l´amparasfluorescentesproducidaspor ciertacompa˜n´ıaesde
1570horas. Siµes lavidamediadelas l´amparasproducidaspor lacompa˜n´ıa, testeasihaysuficiente
Page2
evidenciacomoparaconcluirqueµ̸=1600horasconunniveldesignificaci´onde(a)0.05y(b)0.01. (c)
Calculaelp-valordel test.Puedesasumirqueladesviaci´onest´andarpoblacionalesde120horas.

```{r}




```

9. Respectoal ejercicioanterior, ¿Cu´al esel tama˜node lamuestraquesenecesitar´ıaparadetectaruna
variaci´onde30horasenlavidamediadelasl´amparas,usandounasignificaci´ondel1%yunapotencia
del90%.

```{r}




```



10.Unam´aquinaest´adise˜nadaparaa˜nadirde formaautom´aticapatatasasacosde10Kgconunavari
anzade0.252Kg2. Sinembargo,unamuestraaleatoriade20sacosmuestraunavarianzamuestralde
0.322Kg2. ¿Podemosconcluirqueel incrementoes significativoal (a)5%, (b)1%? Datosen“pota
toes.csv”.

```{r}
# No encuentro el csv



```

2 ICsytestparadospoblacionesnormales



11.Unamuestrade150bombillasdelamarcaAmostraronunaduraci´onmediade1400horasydesviaci´on
t´ıpica120. Porotraparte,100bombillasde lamarcaBmostraronunaduraci´onmediade1200horas
ydesviaci´ont´ıpica80. Hallael intervalode confianzadel 99%para ladiferenciademediasde las
poblacionesAyB. Situviesesquecomprarunasbombillas,¿Cu´alescomprar´ıas?Datosen“bulbs.csv”.

```{r}
data = read.csv("bulbs.csv")
n1 = 150
x1 = 1400
sd1 = 120
n2 = 100
x2 = 1200
sd2 = 80
alpha = 0.01
t = qt(1-alpha/2, n1+n2-2)
sp = sqrt(((n1-1) * (sd1)^2 + (n2-1) * (sd2)^2)/(n1 + n2 - 2))

low = x1 - x2 - t * sp * sqrt((1/n1) + (1/n2))
high = x1 - x2 + t * sp * sqrt((1/n1) + (1/n2))
low
high

```

12. Unamuestrade100bombillasdelamarcaAmostraronunaduraci´onmediade1300horasydesviaci´on
t´ıpicade400horas.Porotraparte,150bombillasdelamarcaBmostraronunaduraci´onmediade1200
horasydesviaci´ont´ıpicade200.Hallael intervalodeconfianzadel99%paraladiferenciademediasde
laspoblacionesAyB. Si tuviesesquecomprarunasbombillas,¿Cu´alescomprar´ıas?


```{r}
n1 = 100
x1 = 1300
sd1 = 400

n2=150
x2=1200
sd2=200
alpha=0.01

z = qnorm(1-alpha/2)

low = x1 - x2 - z * sqrt(((sd1^2)/n1) + ((sd2^2)/n2))
high = x1 - x2 + z * sqrt(((sd1^2)/n1) + ((sd2^2)/n2))
low
high


```

13. Enrelaci´onalproblemaanterior. Siquisi´esemoshacerunestudioconm´asmuestrasparapoderhablar
deresultadossignificativos,¿cu´antasmuestrasser´ıannecesariassiqueremosunniveldesignificaci´ondel
1%yunapotenciadel85%?.

```{r}
power.t.test(delta = 100, sd=400, sig.level = 0.01, power = 0.85, type= "two.sample", alternative = "two.sided")

```

14. Uningenieriocivildeseamedir laresistenciaalacompresi´ondedostiposdecemento, obteniendolas
medidasrecogidasenelfichero“cement.csv”.Asumiendoqueambostiposdecementotienenlamisma
varianza,¿hayevidenciasuficientecomoparaafirmarqueloscementosnotienelamismaresistenciaa
lacompresi´on(conα=0.05)? ¿Cu´al esel tama˜nodel efecto? Si tevieses forzadoaelegirunode los
cementos,¿qu´ecementoelegir´ıas?


```{r}
library("ggplot2")
library("effectsize")
data = read.csv("cement.csv")
alpha = 0.05
data$type = as.factor(data$type)

ggplot(data, aes(x = compressive_strength, col=type)) + geom_density()


a = data[data$type == 1, ]
b = data[data$type == 2, ]
test = t.test(a$compressive_strength, b$compressive_strength, var.equal = TRUE, conf.level = 0.95)
effectsize(test)

# P_valor es 0.06872, con akpha 0.05 no hay suficiente evidencia para decir que su resistencia sea diferente. Cohens d es 0.82 con ic al 95% y el intervalo jasjeaoeiqdq
```

15. Dosmuestrasdetama˜nos16y10setoman, usandomuestreoaleatorioconreemplazamiento, dedos
poblacionesdistintas. Sisusvarianzasmuestralesson25.6y20,respectivamente.Hallalosintervalosal
(a)98%y(b)90%paraelratiodevarianzas.


```{r}
# 98%
n1 = 16
n2 = 10
var1 = 25.6
var2 = 20
alpha = 0.02
qf1 = qf(1-alpha/2, n1-1, n2-1)
qf2 = qf(alpha/2, n1-1, n2-1)

low = (1*var1) / (qf1 * var2)
high = (1*var1) / (qf2 * var2)
low
high


#90%
alpha = 0.1
qf1 = qf(1-alpha/2, n1-1, n2-1)
qf2 = qf(alpha/2, n1-1, n2-1)

low = (1*var1) / (qf1 * var2)
high = (1*var1) / (qf2 * var2)
low
high

```


16. Enunaproductoraagr´ıcolasedeseabaprobarelefectodeunfertilizanteenlaproducci´ondetrigo.Para
ello, seeligieron24parcelasdetierraaproximadamenteigualesyseprob´oel fertilizanteenlamitadde
ellas. El rendimientopromediodetrigoenlasparcelasnotratadas fuede4.8Kgconunadesviaci´on
est´andarmuestralde0.42Kg,mientrasqueelrendimientopromedioenlasparcelastratadasfuede5.1
Kgcondesviaci´onest´andarmuestralde0.37Kg. ¿Podemosconcluirquehayunamejorasignificativa
enlaproducci´ondetrigodebidoal fertilizantesiseusaunniveldesignificaci´onde(a)1%,(b)5%?. (c)
¿Cu´aleselp-valordel test?Puedesasumirquelasvarianzaspoblacionessoniguales.

```{r}
# NI GUARRA
```



17. SequiereestimarmedianteunIC(al95%)elcocientedelasvarianzasdedosr´ıos,parapoderconstruir
unapresadonde estosdesembocan(piensaque si haymuchavariabilidaden los caucesde los r´ıos,
debemostomarprecaucionesextraalahoradedise˜narlapresa;poresolavariabilidadesimportante).
Datosendataics/rivers.csv.

```{r}
library(readr)
data <- read_table("C:/Users/usuario/OneDrive - Fundación Universitaria San Pablo CEU/Escritorio/Ingenieria/Segundo Ingenieria/Estadistica Repitiendo/Estadistica/Estimacion y contraste/Ejercicios/rivers.csv")
data$`"river"` = as.factor(data$`"river"`)

a = data[data$`"river"` == "A", ]
b = data[data$`"river"` == "B", ]

t.test(a$`"flow"`, b$`"flow"`, var.equal = FALSE, conf.level = 0.95)


# NI GUARRA ME FALLAN LOS DATOS
```


18. Seg´unlasespecificacionest´ecnicas, latensi´onalaquerompenloscablesdeunfabricantetienedemedia
1800libras.Usandounanuevat´ecnicademanufacturaci´on,eldepartamentodeI+Dafirmaquelatensi´on
derupturapuede incrementarse. Comoencargadode laspruebasdeverificaci´on, tomasunamuestra
de50cables, encontr´andoseque latensi´onmediaderupturaesde1850libras(datosen“cables.csv”).
¿Hayevidenciacomoparaapoyar laafirmaci´ondeldepartamentodeI+Dconunniveldesignificaci´on
del1%? (Recuerdacalcularel tama˜nodelefecto?).


```{r}
data = read.csv("cables.csv")



ggplot(data, aes(x = x)) + geom_histogram(bins = 15)
# Normal

test = t.test(x = data, alternative = "greater", mu = 1800, conf.level = 0.99)
test
# P valor = 0.0004597 por lo que si se incrementa la tension. Es mayor a 1815 libras. Con cohens D 0.5
effectsize(test)
```

19. . SequiereestimarmedianteunICal99%, ladiferenciaentrelospesosmediosdeloscerebrosdelasvacas
sanasyvacasenfermasporencefalopat´ıaespongiformebovina(enfermedadde lasvacas locas). Datos
encows.csv. ¿Qu´econclusi´onpodr´ıasacarseacercadelospesosdeloscerebros?


```{r}

data = read.csv("cows.csv")
data$healthy = as.factor(data$healthy)
ggplot(data, aes(x = weight_grams, col = healthy))+ geom_density()

# Normales

a = data[data$healthy == TRUE, ]
b = data[data$healthy == FALSE, ]

t.test(a$weight_grams, b$weight_grams, conf.level = 0.99)

# Pesos de cerebros independientes. Obtenemos el intervalo de confianza, no parece haber diferencias p_valor es alto.
```

20. Repite el ejercicio anterior si pudieses asumir que las desviaciones t´ıpicas poblaciones son id´enticas

```{r}
t.test(a$weight_grams, b$weight_grams, conf.level = 0.99, var.equal = TRUE)

```



